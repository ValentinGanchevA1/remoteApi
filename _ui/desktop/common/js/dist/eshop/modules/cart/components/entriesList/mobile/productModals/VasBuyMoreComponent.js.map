{
    "version": 3,
    "sources": ["../../../../../../../../../es6/eshop/modules/cart/components/entriesList/mobile/productModals/VasBuyMoreComponent.jsx"],
    "names": ["VasBuyMoreComponent", "props", "state", "modalVisible", "addButtonClicked", "bind", "closeModalClicked", "entry", "bundleCode", "productCode", "processType", "fetchMobileVases", "console", "log", "setState", "vases", "filter", "v", "propositionId", "length", "services", "updating", "mobileVasUpdatingStatus", "bundleNo", "values", "Object", "j", "VasUpdateStatus", "UPDATING", "header", "detailsHeader", "vasesInCart", "containsVases", "getFilteredVases", "isAnyVasUpdating", "icon", "buyMoreLabel", "idx", "Component", "propTypes", "PropTypes", "number", "object", "func", "array", "mapStateToProps", "mapDispatchToProps", "dispatch", "bundle", "process", "vasElement", "extractMobileVasesForThisSection", "packageCartVasCodes", "getVasesCodes", "filterVasesByCategories", "VAS_PACKAGE_CATEGORY", "excludingRelations", "relations", "r", "type", "filteredVases", "s", "some", "sourceVases", "targetVases", "includes", "id", "rel", "category", "vas", "categories", "map", "find", "element"],
    "mappings": "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",
    "sourcesContent": ["import React, {Component} from \"react\";\nimport PropTypes from 'prop-types';\nimport {connect} from \"react-redux\";\nimport BuyMoreProductsComponent from \"./BuyMoreProductsComponent\";\nimport VasModal from \"./VasModal\";\nimport {OraLoader} from \"eshop/components/OraCommonComponents\";\nimport {fetchMobileVases} from \"eshop/modules/cart/actions/cart\";\nimport VasUpdateStatus from \"eshop/modules/core/enum/VasUpdateStatus\"\nimport {getMobileVases, getMobileVasUpdatingStatus} from \"eshop/modules/cart/selectors\";\nclass VasBuyMoreComponent extends Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            modalVisible: false\n        }\n        this.addButtonClicked = this.addButtonClicked.bind(this);\n        this.closeModalClicked = this.closeModalClicked.bind(this);\n    }\n\n    componentWillMount(){\n        if(this.props.entry.bundleCode && this.props.entry.productCode && this.props.entry.processType){\n            this.props.fetchMobileVases(this.props.entry.bundleCode, this.props.entry.productCode, this.props.entry.processType);\n        }\n    }\n\n    addButtonClicked(){\n        console.log(\"Modal clicked\");\n        this.setState({modalVisible : true}, function(){\n            console.log(\"This state modalVisible: \"+!!this.state.modalVisible);\n        }.bind(this));\n    }\n\n    closeModalClicked(){\n        this.setState({modalVisible : false}, function(){\n            console.log(\"This state modalVisible: \"+!!this.state.modalVisible);\n        }.bind(this));\n    }\n\n    containsVases(){\n        let vases = (this.props.vases || []).filter(v=> v.propositionId == this.props.entry.bundleCode);\n        return vases.length > 0 && vases[0].services && vases[0].services.length > 0;\n    }\n    isAnyVasUpdating(){\n          var updating=this.props.mobileVasUpdatingStatus;\n                if(updating[this.props.entry.bundleNo]){\n                    var values=Object.values(updating[this.props.entry.bundleNo]);\n                    console.log(\"isAnyMobileVasUpdating\",values);\n                    for(var j=0;j<values.length;j++){\n                        console.log(\"isAnyMobileVasUpdating\",values[j]==VasUpdateStatus.UPDATING);\n                        if(values[j]==VasUpdateStatus.UPDATING) return true;\n\n                    }\n                }\n        return false;\n    }\n    render(){\n        var header = this.props.detailsHeader ? this.props.detailsHeader : \"Szczegóły\";\n        let vasesInCart = this.props.entry.vases && this.props.entry.vases.length > 0;\n        const containsVases = this.containsVases();\n        if (containsVases) {\n            const vases = getFilteredVases(this.props.vases, this.props.entry);\n            return (<div className=\"g-white1-bg\">\n                <OraLoader\n                    loading={this.isAnyVasUpdating()}\n                    key={\"loader_\" + this.props.entry.bundleNo + \"_buyMore\"}\n                    id={\"vasComponent-loader\" + this.props.entry.bundleNo + \"_buyMore\"}\n                    parentId=\"cart-loader\"\n                    useHeightFixing={false}\n                >\n                <BuyMoreProductsComponent addButtonClicked={this.addButtonClicked} icon={this.props.icon} buyMoreLabel={this.props.buyMoreLabel} />\n                </OraLoader>\n                <VasModal\n                    cartVases={this.props.entry.vases}\n                    vases={vases}\n                    header={header}\n                    cartBundle={\"\"+this.props.entry.bundleNo}\n                    bundle={this.props.entry.productCode}\n                    propositionId={this.props.entry.bundleCode}\n                    open={this.state.modalVisible}\n                    onClose={this.closeModalClicked}\n                    idx={this.props.idx}/>\n            </div>);\n        } else {\n            return null;\n        }\n    }\n}\n\nVasBuyMoreComponent.propTypes = {\n    idx: PropTypes.number,\n    entry: PropTypes.object,\n    fetchMobileVases: PropTypes.func,\n    vases: PropTypes.array\n}\n\nconst mapStateToProps = (state) => ({\n    vases: getMobileVases(state),\n    mobileVasUpdatingStatus: getMobileVasUpdatingStatus(state),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    fetchMobileVases: (propositionId,bundle,process) => dispatch(fetchMobileVases(propositionId,bundle,process))\n});\n\nexport default connect(mapStateToProps,mapDispatchToProps)(VasBuyMoreComponent);\n\nconst getFilteredVases = (vases, entry) => {\n    const vasElement = extractMobileVasesForThisSection(vases, entry.bundleCode);\n    const packageCartVasCodes = getVasesCodes(filterVasesByCategories(entry.vases, VAS_PACKAGE_CATEGORY));\n    const excludingRelations = (vasElement.relations || []).filter(r => r.type === \"EXCLUDE\");\n    const filteredVases = (vasElement.services || []).filter(s => !excludingRelations.some(r =>\n        [...r.sourceVases, ...r.targetVases].includes(s.id) &&\n        [...r.sourceVases, ...r.targetVases].some(rel => packageCartVasCodes.includes(rel))));\n    return [{...vasElement, services: filteredVases}];\n};\n\nconst VAS_PACKAGE_CATEGORY = \"GratisPackageBonuses\";\n\nconst filterVasesByCategories = (vases, category) =>\n    vases && category && vases.filter(vas => vas.categories && vas.categories.includes(category)) || [];\n\nconst getVasesCodes = vases => vases && vases.map(vas => vas.productCode) || [];\n\nconst extractMobileVasesForThisSection = (vases, bundleCode) =>\n    (vases || []).find(element => element.propositionId === bundleCode);\n"],
    "file": "VasBuyMoreComponent.js"
}