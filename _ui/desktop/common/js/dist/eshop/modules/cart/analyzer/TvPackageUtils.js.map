{
    "version": 3,
    "sources": ["../../../../../../es6/eshop/modules/cart/analyzer/TvPackageUtils.js"],
    "names": ["createCustomRule", "presentable", "createCustomRules", "migratedTvPackages", "customFilters", "customRules", "migratedMainOptvPackage", "findMainOptvMigratedPackage", "allMigratedOptvPackages", "findAllOptvMigratedPackages", "allMigratedOptvPackagesCodes", "map", "mapTvPackageToCode", "allMigratedNcPackages", "findAllNcMigratedPackages", "allMigratedNcPackagesCodes", "push", "createNewMainDisablesOptionalsRule", "createNewNcMainDisablesNcOptionalsRule", "createNewNcMainDisablesMigratedNcPackagesRule", "createNewOptvDisablesMigratedOptvPackagesRule", "createDisableOtherProductsWithSharedBase", "length", "createSelectSpecificMainOptvPackageByDefaultRule", "createRestoreAdditionalPackagesRule", "createSelectDefaultMainPackageRule", "createSelectSpecificMainNcPackageByDefaultRule", "secondaryChoice", "createSecondaryChoiceTvPackagesExcludeRule", "createSecondaryChoiceTvPackagesShowRule", "loyaltyDuration", "tvPackage", "id", "productCode", "TvPackageType", "MAIN_OPTV", "vas", "ALL_OPTV", "ALL_NC", "ruleType", "RuleType", "ANY", "sourceVases", "concat", "BASIC_TV", "targetVases", "OPTIONAL_OPTV", "type", "EXCLUDE_ONCE", "MigrationStatus", "NOT_MIGRATED", "MAIN_NC", "OPTIONAL_NC", "selectedFilter", "NONE", "EXCLUDE", "SHOW", "migratedNcPackages", "migratedOptvPackages", "NOT_BASIC_TV", "findMigratedPackagesNotIncludedInProposition", "defaultPackage", "REQUIRE_SOME", "prod", "base", "migratedWithSharedBase", "filter", "migratedProd", "console", "log", "JSON", "stringify", "obj", "packagesWithBasic", "slice", "migratedPackages", "migratedPackage", "some", "packageInProposition", "arePackagesTheSame", "hasElasticPromo"],
    "mappings": "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",
    "sourcesContent": ["import {Filters} from \"./CartInfoUtils\";\nimport RuleType from \"../../checkout/constants/RuleTypeEnum\";\nimport TvPackageType from \"../../checkout/constants/TvPackageTypeEnum\";\nimport MigrationStatus from \"../enum/MigrationStatus\";\n\nexport function createCustomRule(presentable){\n    return createCustomRules(presentable,[]);\n}\n\nexport function createCustomRules(presentable, migratedTvPackages, customFilters){\n        let customRules = [];\n        let migratedMainOptvPackage = findMainOptvMigratedPackage(migratedTvPackages);\n        let allMigratedOptvPackages = findAllOptvMigratedPackages(migratedTvPackages);\n        let allMigratedOptvPackagesCodes = allMigratedOptvPackages.map(mapTvPackageToCode);\n        let allMigratedNcPackages = findAllNcMigratedPackages(migratedTvPackages);\n        let allMigratedNcPackagesCodes = allMigratedNcPackages.map(mapTvPackageToCode);\n        customRules.push(createNewMainDisablesOptionalsRule(presentable));\n        customRules.push(createNewNcMainDisablesNcOptionalsRule(presentable));\n        customRules.push(createNewNcMainDisablesMigratedNcPackagesRule(presentable,allMigratedNcPackages));\n        customRules.push(createNewOptvDisablesMigratedOptvPackagesRule(presentable,allMigratedOptvPackages));\n        customRules.push(...createDisableOtherProductsWithSharedBase(presentable,migratedTvPackages));\n        if(allMigratedOptvPackages && allMigratedOptvPackages.length > 0){\n            if(migratedMainOptvPackage && migratedMainOptvPackage.length > 0){\n                customRules.push(createSelectSpecificMainOptvPackageByDefaultRule(presentable, allMigratedOptvPackagesCodes));\n            } else {\n                customRules.push(createRestoreAdditionalPackagesRule(presentable, allMigratedOptvPackagesCodes));\n            }\n        } else {\n            customRules.push(createSelectDefaultMainPackageRule(presentable));\n        }\n        if(allMigratedNcPackages && allMigratedNcPackages.length > 0){\n            customRules.push(createSelectSpecificMainNcPackageByDefaultRule(presentable, allMigratedNcPackagesCodes));\n        }\n        if(customFilters && customFilters.secondaryChoice) {\n            customRules.push(createSecondaryChoiceTvPackagesExcludeRule(presentable, customFilters.secondaryChoice))\n            customRules.push(createSecondaryChoiceTvPackagesShowRule(presentable, customFilters.secondaryChoice))\n        }\n        if(customFilters && customFilters.loyaltyDuration) {\n            customRules.push(createSecondaryChoiceTvPackagesExcludeRule(presentable, customFilters.loyaltyDuration))\n            customRules.push(createSecondaryChoiceTvPackagesShowRule(presentable, customFilters.loyaltyDuration))\n        }\n        return customRules;\n}\n\nfunction mapTvPackageToCode(tvPackage) {\n    return tvPackage.id || tvPackage.productCode;\n}\n\nfunction findMainOptvMigratedPackage(migratedTvPackages){\n    return Filters()[TvPackageType.MAIN_OPTV](migratedTvPackages).map(vas => vas.id || vas.productCode);\n}\n\nfunction findAllOptvMigratedPackages(migratedTvPackages){\n    return Filters()[TvPackageType.ALL_OPTV](migratedTvPackages);\n}\n\nfunction findAllNcMigratedPackages(migratedTvPackages){\n    return Filters()[TvPackageType.ALL_NC](migratedTvPackages);\n}\n\nfunction createNewMainDisablesOptionalsRule(presentable){\n    return {\n        ruleType: RuleType.ANY,\n        sourceVases: Filters()[TvPackageType.MAIN_OPTV](presentable).concat(Filters()[TvPackageType.BASIC_TV](presentable)).map(vas => vas.id || vas.productCode),\n        targetVases: Filters()[TvPackageType.OPTIONAL_OPTV](presentable).map(vas => vas.id || vas.productCode),\n        type: RuleType.EXCLUDE_ONCE\n    };\n}\n\nfunction createNewNcMainDisablesNcOptionalsRule(presentable){\n    return {\n        ruleType: RuleType.ANY,\n        sourceVases: Filters()[MigrationStatus.NOT_MIGRATED](Filters()[TvPackageType.MAIN_NC](presentable)).map(vas => vas.id || vas.productCode),\n        targetVases: Filters()[TvPackageType.OPTIONAL_NC](presentable).map(vas => vas.id || vas.productCode),\n        type: RuleType.EXCLUDE_ONCE\n    };\n}\n\nfunction createSecondaryChoiceTvPackagesExcludeRule(presentable,selectedFilter) {\n    return {\n        ruleType: RuleType.NONE,\n        sourceVases: [],\n        targetVases: Filters()[selectedFilter](presentable).map(vas => vas.id || vas.productCode),\n        type: RuleType.EXCLUDE\n    };\n}\n\nfunction createSecondaryChoiceTvPackagesShowRule(presentable,selectedFilter) {\n    return {\n        ruleType: RuleType.ANY,\n        sourceVases: [],\n        targetVases: Filters()[selectedFilter](presentable).map(vas => vas.id || vas.productCode),\n        type: RuleType.SHOW\n    };\n}\n\nfunction createNewNcMainDisablesMigratedNcPackagesRule(presentable,migratedNcPackages){\n    return {\n        ruleType: RuleType.ANY,\n        sourceVases: Filters()[MigrationStatus.NOT_MIGRATED](Filters()[TvPackageType.MAIN_NC](presentable)).map(vas => vas.id || vas.productCode),\n        targetVases: migratedNcPackages.map(mapTvPackageToCode),\n        type: RuleType.EXCLUDE_ONCE\n    };\n}\n\nfunction createNewOptvDisablesMigratedOptvPackagesRule(presentable,migratedOptvPackages){\n    return {\n        ruleType: RuleType.ANY,\n        sourceVases: Filters()[TvPackageType.NOT_BASIC_TV](Filters()[TvPackageType.ALL_OPTV](Filters()[MigrationStatus.NOT_MIGRATED](presentable))).map(vas => vas.id || vas.productCode),\n        targetVases: findMigratedPackagesNotIncludedInProposition(presentable, migratedOptvPackages),\n        type: RuleType.EXCLUDE_ONCE\n    };\n}\n\nfunction createSelectSpecificMainOptvPackageByDefaultRule(presentable, defaultPackage){\n    return {\n        ruleType: RuleType.NONE,\n        sourceVases: Filters()[TvPackageType.NOT_BASIC_TV](Filters()[TvPackageType.ALL_OPTV](Filters()[MigrationStatus.NOT_MIGRATED](presentable))).map(vas => vas.id || vas.productCode),\n        targetVases: defaultPackage,\n        type: RuleType.REQUIRE_SOME\n    };\n}\n\nfunction createSelectSpecificMainNcPackageByDefaultRule(presentable, defaultPackage){\n    return {\n        ruleType: RuleType.NONE,\n        sourceVases: Filters()[TvPackageType.MAIN_NC](presentable).map(vas => vas.id || vas.productCode),\n        targetVases: defaultPackage,\n        type: RuleType.REQUIRE_SOME\n    };\n}\n\nfunction createDisableOtherProductsWithSharedBase(presentable,migratedTvPackages){\n    return Filters()[MigrationStatus.NOT_MIGRATED](presentable)\n    .map(prod => {\n        let base = prod.base;\n        let migratedWithSharedBase = migratedTvPackages.filter(migratedProd => base === migratedProd.base)\n        .map(migratedProd => migratedProd.id)\n        .filter(migratedProd => migratedProd !== prod.id);\n        if(migratedWithSharedBase.length > 0){\n            console.log(\"Creating rule: \"+prod.id+\" disables \"+JSON.stringify(migratedWithSharedBase));\n                return {\n                    ruleType: RuleType.ANY,\n                    sourceVases: [prod.id],\n                    targetVases: migratedWithSharedBase,\n                    type: RuleType.EXCLUDE\n                }\n        }\n        return null;\n    })\n    .filter(obj => !!obj);\n}\n\nfunction createRestoreAdditionalPackagesRule(presentable, defaultPackage){\n    let packagesWithBasic = defaultPackage.slice();\n    packagesWithBasic = packagesWithBasic.concat(Filters()[TvPackageType.BASIC_TV](presentable).map(vas => vas.id || vas.productCode));\n    return createSelectSpecificMainOptvPackageByDefaultRule(presentable, packagesWithBasic);\n}\n\nfunction createSelectDefaultMainPackageRule(presentable){\n    return createSelectSpecificMainOptvPackageByDefaultRule(presentable, Filters()[TvPackageType.BASIC_TV](presentable).map(vas => vas.id || vas.productCode));\n}\n\nfunction findMigratedPackagesNotIncludedInProposition(presentable, migratedPackages) {\n    return migratedPackages.filter(migratedPackage =>\n        !presentable.some(packageInProposition => arePackagesTheSame(packageInProposition, migratedPackage))\n    ).map(mapTvPackageToCode);\n}\n\nfunction arePackagesTheSame(packageInProposition, migratedPackage) {\n    return packageInProposition.id === migratedPackage.id\n        || (packageInProposition.hasElasticPromo && packageInProposition.base === migratedPackage.base);\n}\n"],
    "file": "TvPackageUtils.js"
}