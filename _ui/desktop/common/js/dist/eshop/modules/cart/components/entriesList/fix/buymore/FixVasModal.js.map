{
    "version": 3,
    "sources": ["../../../../../../../../../es6/eshop/modules/cart/components/entriesList/fix/buymore/FixVasModal.jsx"],
    "names": ["FixVASModal", "props", "state", "open", "popup", "callback", "event", "modalContent", "nextProps", "setState", "onClose", "onSave", "productCode", "propositionId", "onClick", "_cancelInterceptedClick", "vasesWithStatuses", "services", "map", "vas", "selected", "mandatory", "presentation", "Object", "keys", "entries", "filter", "find", "id", "forEach", "mandatories", "hidden", "configurables", "descriptions", "_onClickInterceptor", "bind", "productList", "selectedSection", "showNetPrices", "uid", "migratedProducts", "_runInterceptedClick", "_onSaveWrapper", "Component", "propTypes", "PropTypes", "string", "header", "bundle", "cartBundle", "bool", "object", "array", "FixVASModalContent", "getSortedPresentableProductsOf", "type", "productsOrder", "products", "presentableProducts", "p", "addonType", "deviceType", "sort", "renderSection", "command", "renderTvVasesSection", "renderCommonSection", "index", "section", "onClickWrapped", "isExpanded", "innerLists", "productFilter", "productCodes", "renderCommand"],
    "mappings": "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",
    "sourcesContent": ["import React, {Component} from \"react\";\nimport {PropTypes} from \"prop-types\";\nimport OraModal from \"eshop/modules/core/components/ui/Modal\";\nimport {Expander} from \"eshop/modules/core/components/ui/Expander\";\nimport {compareByProductListAndMandatoryAndTitle, Filters} from \"../../../../analyzer/CartInfoUtils\";\nimport {IfCollectionNotEmpty} from \"./Utils\";\nimport {SaveVasesButton, TitledFoldableProductGroup, TitledFoldableTvVasesProductGroup} from \"./modalFragments/ModalFragments\"\nimport {prepareDevices} from \"../../../../analyzer/DeviceUtils\";\nimport {Warning} from \"../../shared/MessageBox\";\nimport {CloseAndSaveVasesButtons} from \"eshop/modules/cart/components/entriesList/convergent/vasModal/CloseAndSaveVasesButtons\";\n\nexport default class FixVASModal extends Component  {\n    constructor (props) {\n        super(props);\n        this.state = {\n            open: this.props.open,\n            popup: false,\n            callback: null,\n            event: null,\n            modalContent: null\n        }\n    }\n\n    componentWillReceiveProps(nextProps){\n\n        this.setState({\n            open: nextProps.open\n        })\n    }\n\n    _onSaveWrapper(){\n        this.props.onClose();\n        this.props.onSave();\n    }\n\n    _onClickInterceptor(productCode, propositionId, modalContent) {\n        return (event) => {\n            this.setState({\n                popup: true,\n                callback: this.props.onClick(productCode, propositionId),\n                event: event,\n                modalContent: modalContent\n            });\n        }\n    }\n\n    _runInterceptedClick() {\n        this.state.callback(this.state.event);\n        this._cancelInterceptedClick();\n    }\n\n    _cancelInterceptedClick() {\n        this.setState({\n            popup: false,\n            callback: null,\n            event: null,\n            modalContent: null\n        });\n    }\n\n    render(){\n        let vasesWithStatuses = this.props.services.map(vas => {\n            vas.selected = false;\n            vas.mandatory = false;\n            vas.presentation = \"visible\";\n            return vas;\n        });\n        Object.keys(this.props.entries)\n            .filter(productCode => this.props.entries[productCode])\n            .map(productCode => vasesWithStatuses.find(vas => vas.id === productCode))\n            .filter(vas => vas)\n            .forEach(vas => vas.selected = true);\n        this.props.mandatories\n            .filter(productCode => this.props.entries[productCode])\n            .map(productCode => vasesWithStatuses.find(vas => vas.id === productCode))\n            .filter(vas => vas)\n            .forEach(vas => vas.mandatory = true);\n        if(this.props.hidden) {\n            this.props.hidden\n                    .map(productCode => vasesWithStatuses.find(vas => vas.id === productCode))\n            .filter(vas => vas)\n            .forEach(vas => vas.presentation = \"hidden\");\n        }\n\n        return(\n        <OraModal open={this.props.open} onClose={this.props.onClose} size=\"medium\">\n            <FixVASModalContent\n                configurables = {this.props.configurables}\n                descriptions = {this.props.descriptions}\n                onClickWrapped={this._onClickInterceptor.bind(this)}\n                onClick={this.props.onClick}\n                productList={this.props.productList}\n                selectedSection = {this.props.selectedSection}\n                showNetPrices={this.props.showNetPrices}\n                uid={this.props.uid}\n                vasesWithStatuses={vasesWithStatuses}\n                migratedProducts={this.props.migratedProducts}\n            />\n            {\n                this.state.popup &&\n                <Warning\n                    onAccept={this._runInterceptedClick.bind(this)}\n                    onCancel={this._cancelInterceptedClick.bind(this)}\n                    modalContents={this.state.modalContent}\n                />\n            }\n            <div className=\"l-row\">\n                <CloseAndSaveVasesButtons onClose={this.props.onClose} saveVasesClicked={this._onSaveWrapper.bind(this)}/>\n            </div>\n        </OraModal>)\n    }\n}\n\nFixVASModal.propTypes = {\n    uid: PropTypes.string,\n    header: PropTypes.string,\n    bundle: PropTypes.string,\n    cartBundle: PropTypes.string,\n    propositionId: PropTypes.string,\n    open: PropTypes.bool,\n    descriptions: PropTypes.object,\n    services: PropTypes.array,\n    entries: PropTypes.object,\n    mandatories: PropTypes.array,\n    productList: PropTypes.object,\n    hidden: PropTypes.array\n}\n\nconst FixVASModalContent = (props) => {\n\n    function getSortedPresentableProductsOf(type, productsOrder){\n        let products = Filters()[type](props.vasesWithStatuses);\n        const presentableProducts = [\n            ...products.filter(p => !!p.addonType && !p.mandatory),\n            ...prepareDevices(products.filter(p => !!p.deviceType), props.descriptions, props.migratedProducts)];\n        presentableProducts.sort(compareByProductListAndMandatoryAndTitle(productsOrder));\n        return presentableProducts;\n    }\n\n    function renderSection(command){\n        if (command.type  === \"TV_VASES\"){\n            return renderTvVasesSection(command);\n        }\n        return renderCommonSection(command);\n    }\n\n    function renderTvVasesSection(command){\n        return (\n            <div>\n                <IfCollectionNotEmpty array={command.products} key={\"ICNE_\" + command.index}>\n                    <TitledFoldableTvVasesProductGroup\n                        key={\"TPG_\" + command.index}\n                        uid={\"TPG_\" + command.index}\n                        idx={command.type}\n                        section={command.section}\n                        products={command.products}\n                        onClick={command.onClick}\n                        onClickWrapped={command.onClickWrapped}\n                        isExpanded={command.isExpanded}\n                        net={command.showNetPrices}\n                        configurables={command.configurables}\n                        descriptions={command.descriptions}\n                    />\n                </IfCollectionNotEmpty>\n            </div>\n        );\n    }\n\n    function renderCommonSection( command) {\n        return (\n            <IfCollectionNotEmpty array={command.products} key={\"ICNE_\" + command.index}>\n                <TitledFoldableProductGroup\n                    key={\"TPG_\" + command.index}\n                    uid={\"TPG_\" + command.index}\n                    idx={command.type}\n                    section={command.section}\n                    products={command.products}\n                    onClick={command.onClick}\n                    onClickWrapped={command.onClickWrapped}\n                    isExpanded={command.isExpanded}\n                    net={command.showNetPrices}\n                    configurables={command.configurables}\n                />\n            </IfCollectionNotEmpty>\n        );\n    }\n\n    return (\n        <div>\n            <p className=\"h3\">Dobierz usługi dodatkowe</p>\n            <Expander id={`exp-${props.uid}`} variant=\"section\" className=\"opl-vas-modal-expander\" scrollToSelected={false}>\n                <div className=\"o-separator o-separator--m\"/>\n                {\n                    props.productList &&\n                    props.productList.innerLists &&\n                    props.productList.innerLists.map((section, index) => {\n                        let type = section.productFilter;\n                        const isExpanded = props.selectedSection === section.productFilter;\n                        let productsOrder = section.productCodes || [];\n                        const presentableProducts = getSortedPresentableProductsOf(type, productsOrder);\n                        const renderCommand = {\n                            ...props,\n                            index:  index,\n                            section: section,\n                            products: presentableProducts,\n                            isExpanded: isExpanded,\n                            type: type\n                        };\n                        return renderSection(renderCommand);\n                    })\n                }\n            </Expander>\n        </div>\n    );\n}"],
    "file": "FixVasModal.js"
}