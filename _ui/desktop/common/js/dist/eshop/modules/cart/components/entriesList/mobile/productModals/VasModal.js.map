{
    "version": 3,
    "sources": ["../../../../../../../../../es6/eshop/modules/cart/components/entriesList/mobile/productModals/VasModal.jsx"],
    "names": ["VAS_CHARACTERISTIC_MANDATORY", "VASModal", "props", "extractMobileVasesForThisSection", "bind", "markAlreadySelectedVases", "disabledMandatoryVases", "createClickedCallback", "findBrokenRequireRules", "findBrokenDisableRules", "findTriggeredValidationGroups", "isRuleTriggered", "isValidationGroupTriggered", "createVasIdToNameTranslationMap", "saveSelectedVases", "state", "open", "services", "requireRules", "disableRules", "groups", "oldServices", "unfulfilledRequireRules", "triggeredValidationGroups", "nextProps", "vasesWithRules", "markedVases", "viewAsRetentionBonuses", "categorizedBonuses", "setState", "JSON", "parse", "stringify", "filterRequireRules", "filterUsableRules", "relations", "filterDisableRules", "filterUsableValidationGroups", "console", "log", "rules", "serviceCodes", "map", "service", "id", "filter", "rule", "targets", "targetVases", "vas", "includes", "sources", "sourceVases", "length", "type", "RuleType", "REQUIRE", "EXCLUDE", "group", "targetProducts", "product", "conditionals", "conditionalProducts", "vases", "find", "element", "bundle", "cartVasCodes", "cartVases", "productCode", "indexOf", "Object", "assign", "selected", "characteristics", "disabled", "selectedVasCodes", "areAllRuleTargetsPresent", "areAnyRuleTargetsPresent", "allVasCodes", "triggeredGroups", "disabledProducts", "reduce", "products", "concat", "value", "index", "array", "active", "every", "selectedId", "brokenRequireRules", "uncheckExcludeVases", "excludeVases", "forEach", "push", "vasClicked", "ser", "updateUnfulfilledRules", "translationMap", "freeze", "title", "bonuses", "bonus", "code", "diff", "servicesStateDiff", "toBeSelected", "getVasAndBonusesIdsFromVas", "prev", "current", "toBeRemoved", "onClose", "updateCartVases", "propositionId", "cartBundle", "newServices", "idx", "changed", "numberOfVasesVisibleByDefault", "slice", "multiChoice", "getSectionHeader", "Component", "propTypes", "header", "PropTypes", "string", "bool", "func", "number", "defaultProps", "SaveVasesButton", "shouldDisableButton", "saveVasesClicked", "isRequired", "mapDispatchToProps", "dispatch", "offer", "productsToRemove", "productsToAdd"],
    "mappings": "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",
    "sourcesContent": ["import React, {Component} from \"react\";\nimport {PropTypes} from \"prop-types\";\nimport {connect} from \"react-redux\";\nimport OraModal from \"eshop/modules/core/components/ui/Modal\";\nimport {updateCartVases} from \"eshop/modules/cart/actions/cart\";\nimport VASBox from \"./VasBox\";\nimport {RequireRuleMessageComponent} from \"./ValidationResultMessageComponent\";\nimport {Expander, Section, Trigger} from \"eshop/modules/core/components/ui/Expander\";\nimport RuleType from \"../../../../../checkout/constants/RuleTypeEnum\";\n\nconst VAS_CHARACTERISTIC_MANDATORY = \"MANDATORY\";\n\nclass VASModal extends Component  {\n    constructor (props) {\n        super(props);\n        this.extractMobileVasesForThisSection = this.extractMobileVasesForThisSection.bind(this);\n        this.markAlreadySelectedVases = this.markAlreadySelectedVases.bind(this);\n        this.disabledMandatoryVases = this.disabledMandatoryVases.bind(this);\n        this.createClickedCallback = this.createClickedCallback.bind(this);\n        this.findBrokenRequireRules = this.findBrokenRequireRules.bind(this);\n        this.findBrokenDisableRules = this.findBrokenDisableRules.bind(this);\n        this.findTriggeredValidationGroups = this.findTriggeredValidationGroups.bind(this);\n        this.isRuleTriggered = this.isRuleTriggered.bind(this);\n        this.isValidationGroupTriggered = this.isValidationGroupTriggered.bind(this);\n        this.createVasIdToNameTranslationMap = this.createVasIdToNameTranslationMap.bind(this);\n        this.saveSelectedVases = this.saveSelectedVases.bind(this);\n        this.state = {\n            open: this.props.open,\n            services: [],\n            requireRules: [],\n            disableRules: [],\n            groups: [],\n            oldServices: [],\n            unfulfilledRequireRules: [],\n            triggeredValidationGroups : []\n        }\n    }\n\n    componentWillReceiveProps(nextProps){\n        var vasesWithRules = this.extractMobileVasesForThisSection(nextProps);\n        var markedVases = this.markAlreadySelectedVases(vasesWithRules.services,nextProps);\n        if(this.props.viewAsRetentionBonuses && vasesWithRules.categorizedBonuses[\"RetentionBonuses\"]){\n            markedVases = this.markAlreadySelectedVases(vasesWithRules.categorizedBonuses[\"RetentionBonuses\"].services,nextProps);\n        }\n        markedVases = this.disabledMandatoryVases(markedVases);\n\n        if(vasesWithRules){\n            this.setState({\n                open: nextProps.open,\n                oldServices: JSON.parse(JSON.stringify(markedVases)),\n                services : markedVases,\n                requireRules : this.filterRequireRules(this.filterUsableRules(vasesWithRules.relations,markedVases)),\n                disableRules: this.filterDisableRules(this.filterUsableRules(vasesWithRules.relations,markedVases)),\n                groups : this.filterUsableValidationGroups(vasesWithRules.groups,markedVases),\n                unfulfilledRequireRules: [],\n                triggeredValidationGroups : []\n            });\n        } else {\n            this.setState({\n                open: nextProps.open\n            }, function(){\n                console.log(\"This state open: \"+!!this.state.open);\n            }.bind(this));\n        }\n    }\n\n\n    filterUsableRules(rules,services){\n        const serviceCodes = services.map((service) => service.id);\n        return rules.filter((rule) => {\n            let targets = rule.targetVases.filter(vas => serviceCodes.includes(vas));\n            let sources = rule.sourceVases.filter(vas => serviceCodes.includes(vas));\n            //Usable rule contains available vases on both sides\n            if(targets.length > 0 && sources.length > 0){\n                //Analyzing state of unavailable vases is pointless\n                //leave only those possible to select\n                rule.targetVases = targets;\n                rule.sourceVases = sources;\n                return rule;\n            }\n        })\n    }\n\n    filterRequireRules(rules){\n        return rules.filter((rule) => rule.type === RuleType.REQUIRE);\n    }\n\n    filterDisableRules(rules){\n        return rules.filter((rule) => rule.type === RuleType.EXCLUDE);\n    }\n\n    filterUsableValidationGroups(groups,services){\n        const serviceCodes = services.map((service) => service.id);\n        return groups.filter((group) => {\n            const targets = group.targetProducts.filter(product => serviceCodes.includes(product));\n            const conditionals = group.conditionalProducts.filter(product => serviceCodes.includes(product));\n            if(targets.length > 0 && conditionals.length > 0){\n                return group;\n            }\n        });\n    }\n\n    extractMobileVasesForThisSection(props){\n        return props.vases.find(element => element.bundle === props.bundle);\n    }\n\n    markAlreadySelectedVases(services,props){\n        var cartVasCodes = props.cartVases.map(vas => vas.productCode);\n        cartVasCodes = cartVasCodes ? cartVasCodes : [];\n        if(!services){\n            return [];\n        }\n        return services.map(vas => {\n            if(cartVasCodes.indexOf(vas.id)!=-1){\n                return Object.assign({},vas,{selected:true});\n            }\n            return Object.assign({},vas,{selected:false});\n        });\n    }\n\n    disabledMandatoryVases(vases){\n        return vases.map(vas => {\n            if(vas.characteristics.indexOf(VAS_CHARACTERISTIC_MANDATORY) != -1){\n                return Object.assign({},vas,{disabled:true});\n            }\n            return Object.assign({},vas,{disabled:false});\n        });\n    }\n\n    isRuleTriggered(rule,serviceCodes){\n        return rule.sourceVases.filter(vas => serviceCodes.includes(vas)).length > 0;\n    }\n\n    isValidationGroupTriggered(group,serviceCodes){\n        return group.conditionalProducts.filter(product => serviceCodes.includes(product)).length > 0;\n    }\n\n    findBrokenRequireRules(services){\n        var selectedVasCodes = services.filter(service => service.selected).map(service => service.id);\n        console.log(\"Find broken require rules\");\n        return this.state.requireRules\n            .filter(rule => this.isRuleTriggered(rule,selectedVasCodes))\n            .filter(rule => !this.areAllRuleTargetsPresent(rule,selectedVasCodes));\n    }\n\n    findBrokenDisableRules(services){\n        var selectedVasCodes = services.filter(service => service.selected).map(service => service.id);\n        console.log(\"Find broken disable rules\");\n        return this.state.disableRules\n            .filter(rule => this.isRuleTriggered(rule,selectedVasCodes))\n            .filter(rule => this.areAnyRuleTargetsPresent(rule,selectedVasCodes));\n    }\n\n    findTriggeredValidationGroups(services){\n        var selectedVasCodes = services.filter(service => service.selected).map(service => service.id);\n        let allVasCodes = services.map(service => service.id);\n        console.log(\"Find triggered validation groups\");\n        let triggeredGroups = this.state.groups.filter(group => this.isValidationGroupTriggered(group,selectedVasCodes));\n        let disabledProducts = triggeredGroups.reduce((products,group) => {\n            return products.concat(group.targetProducts.filter(product => allVasCodes.includes(product)))\n        },[]).filter((value,index,array) => array.indexOf(value) === index);\n        services = services.map((service) => {\n            service.active = !disabledProducts.includes(service.id);\n        })\n        return triggeredGroups;\n    }\n\n    areAllRuleTargetsPresent(rule,selectedVasCodes){\n        return rule.targetVases.every((product) => selectedVasCodes.includes(product));\n    }\n\n    areAnyRuleTargetsPresent(rule,selectedVasCodes){\n        return rule.targetVases.find((product) => selectedVasCodes.includes(product));\n    }\n\n    updateUnfulfilledRules(services, selectedId){\n        var brokenRequireRules = this.findBrokenRequireRules(services);\n        this.uncheckExcludeVases(services, selectedId);\n\n        var triggeredValidationGroups = this.findTriggeredValidationGroups(services);\n        this.setState({\n            services : services,\n            unfulfilledRequireRules: brokenRequireRules,\n            triggeredValidationGroups: triggeredValidationGroups\n        });\n        console.log(\"Broken rules:\");\n        console.log(JSON.stringify(brokenRequireRules));\n        console.log(JSON.stringify(triggeredValidationGroups));\n    }\n\n    uncheckExcludeVases(services, selectedId) {\n        var excludeVases = [];\n        this.state.disableRules\n            .filter(rule => rule.sourceVases.filter(vas => vas === selectedId).length > 0)\n            .forEach(rule => rule.targetVases.forEach(vas => excludeVases.push(vas)));\n        services.forEach(service => {\n            if (excludeVases.includes(service.id)) {\n                service.selected = false;\n            }\n        });\n    }\n\n    createClickedCallback(vas){\n        var vasClicked = () => {\n            console.log(\"VAS CLICKED \",vas);\n            var services = this.state.services;\n            var index = services.indexOf(vas);\n            console.log(\"index\",index);\n            if(index!=-1){\n                if(this.props.viewAsRetentionBonuses){\n                    services.forEach(ser => ser.selected=false);\n                    vas.selected=true;\n\n                }else{\n                    vas.selected = !vas.selected;\n                }\n                services[index] = vas;\n\n                this.updateUnfulfilledRules(services, vas.id);\n                console.log(\"CLICKED: \"+JSON.stringify(vas));\n            }\n        }\n        return vasClicked.bind(this);\n    }\n\n    createVasIdToNameTranslationMap(){\n        var translationMap = {};\n        return Object.freeze(this.state.services.reduce((map,vas) => {\n            map[vas.id] = vas.title;\n            return map;\n        },translationMap));\n    }\n\n    getVasAndBonusesIdsFromVas(vas){\n        let bonuses = vas.bonuses ? vas.bonuses.map(bonus => bonus.code) : [];\n        return [vas.id, ...bonuses];\n    }\n\n    saveSelectedVases(){\n        console.log(\"Save vases clicked\");\n        let diff = this.servicesStateDiff(this.state.oldServices,this.state.services);\n        console.log(\"Diff:\");\n        console.log(JSON.stringify(diff));\n        let toBeSelected = diff.filter(vas => vas.selected).map(this.getVasAndBonusesIdsFromVas.bind(this)).reduce((prev,current) => prev.concat(...current), []);\n        let toBeRemoved = diff.filter(vas => !vas.selected).map(this.getVasAndBonusesIdsFromVas.bind(this)).reduce((prev,current) => prev.concat(...current), []);\n        this.setState({\n            oldServices: JSON.parse(JSON.stringify(this.state.services)),\n            open: false\n        })\n        this.props.onClose();\n        this.props.updateCartVases(this.props.propositionId,this.props.bundle,this.props.cartBundle,toBeRemoved,toBeSelected);\n    }\n\n    servicesStateDiff(oldServices,newServices){\n        if(oldServices.length !== newServices.length){\n            throw \"Something went wrong. Service lists' sizes do not match.\";\n        }\n        const diff = newServices.map((vas,idx) => {\n            vas.changed = vas.selected !== oldServices[idx].selected;\n            return vas;\n        }).filter(vas => vas.changed);\n        return diff;\n    }\n\n    getSectionHeader() {\n        return (\n            <div className=\"l-row u-spacing-top-l u-small-spacing-m\">\n                <div className=\"l-col l-col-small-12 l-col-medium-8 l-col-8\">\n                    <Trigger className=\"js-expander__trigger__nested u-inline u-text-nowrap\">\n                        <span className=\"js-expander__trigger--show\">{\"Mniej\\u00a0usług\"}</span>\n                        <span className=\"js-expander__trigger--hide\">{\"Więcej\\u00a0usług\"}</span>\n                    </Trigger>\n                </div>\n                <SaveVasesButton unfulfilledRequireRules={this.state.unfulfilledRequireRules} saveVasesClicked={this.saveSelectedVases}/>\n            </div>\n        );\n    }\n\n    render(){\n        const translationMap = this.createVasIdToNameTranslationMap();\n        const numberOfVasesVisibleByDefault = 4;\n        console.log(\"VAS MODAL RENDER PROPS:\",this.props);\n        console.log(\"VAS MODAL RENDER STATE:\",this.state);\n        return(\n        <OraModal open={this.state.open} onClose={this.props.onClose} size=\"medium\">\n            <p className=\"h3\">{this.props.title}</p>\n                <div className=\"opl-multicheckout-services\">\n                    <Expander scrollToSelected={false} variant=\"\" className=\"opl-expander-outer u-no-padding\" sectionClassName=\"opl-section-outer\">\n                        <ul>\n                            {this.state.services && this.state.services.slice(0,numberOfVasesVisibleByDefault).map((vas, idx, vases) => {\n                                return (\n                                    <li className=\"opl-multicheckout-services__item\" key={\"vas_\"+idx}>\n                                        <VASBox key={`${vas.id}_${idx}`} multiChoice={this.props.multiChoice}\n                                                onSelectionChanged={this.createClickedCallback(vas)} vas={vas}\n                                                idx={vases.length - idx}/>\n                                    </li>\n                                );\n                            })}\n                        </ul>\n                    </Expander>\n                        {this.state.services.length && this.state.services.length > numberOfVasesVisibleByDefault ?\n                            (<Expander scrollToSelected={false} variant=\"\" className=\"opl-expander-inner u-no-padding\" sectionClassName=\"opl-section-inner\">\n                            <Section header={this.getSectionHeader()}\n                                     contentClassName=\"js-expander__content__nested u-hide--soft\"\n                                     className=\"opl-section-inner u-no-padding\" headerBelow={true}>\n                                <Expander scrollToSelected={false} variant=\"\" className=\"opl-expander-outer u-no-padding\" sectionClassName=\"opl-section-outer\">\n                                    <ul>\n                                        <li className=\"opl-multicheckout-services__item\" key={\"vas_blank\"}/>\n                                        {this.state.services && this.state.services.slice(numberOfVasesVisibleByDefault).map((vas, idx, vases) => {\n                                            const index = idx + numberOfVasesVisibleByDefault;\n                                            return (\n                                                <li className=\"opl-multicheckout-services__item\" key={\"vas_\"+index}>\n                                                    <VASBox key={`${vas.id}_${index}`}\n                                                            multiChoice={this.props.multiChoice}\n                                                            onSelectionChanged={this.createClickedCallback(vas)}\n                                                            vas={vas}\n                                                            idx={vases.length - index + numberOfVasesVisibleByDefault}/>\n                                                </li>\n                                            );\n                                        })}\n                                    </ul>\n                                </Expander>\n                            </Section>\n                        </Expander>)\n                            : (<div className=\"l-row u-spacing-top-l u-small-spacing-m\">\n                                <div className=\"l-col l-col-small-12 l-col-medium-8 l-col-8\"/>\n                                <SaveVasesButton unfulfilledRequireRules={this.state.unfulfilledRequireRules}\n                                                 saveVasesClicked={this.saveSelectedVases}/>\n                            </div>)}\n                </div>\n            {this.state.unfulfilledRequireRules.length > 0 && <RequireRuleMessageComponent translationMap={translationMap} brokenRules={this.state.unfulfilledRequireRules}>UNFULFILLED REQUIRE RULES</RequireRuleMessageComponent>}\n        </OraModal>)\n    }\n}\n\nVASModal.propTypes = {\n    header: PropTypes.string,\n    bundle: PropTypes.string,\n    cartBundle: PropTypes.string,\n    propositionId: PropTypes.string,\n    open: PropTypes.bool,\n    onClose: PropTypes.func,\n    idx: PropTypes.number,\n    cartVases: PropTypes.array,\n    updateCartVases: PropTypes.func,\n};\nVASModal.defaultProps = {\n    title:\"Dobierz usługi dodatkowe\",\n\n};\nconst SaveVasesButton = props => {\n    const shouldDisableButton = props.unfulfilledRequireRules.length > 0;\n    if(shouldDisableButton){\n        return (<div className=\"l-col l-col-small-12 l-col-medium-4 l-col-4 u-small-padding-top\">\n            <button className=\"o-btn opl-btn opl-btn--primary opl-btn-medium u-w-100\" disabled>\n                <span className=\"opl-ripple-box\">\n                    <span className=\"opl-ripple-circle\"/>\n                </span>Wybierz usługi\n            </button>\n        </div>);\n    } else {\n        return (<div className=\"l-col l-col-small-12 l-col-medium-4 l-col-4 u-text-right u-small-padding-top\">\n            <button className=\"o-btn opl-btn opl-btn--primary opl-btn-medium u-w-100\" onClick={props.saveVasesClicked}>\n                <span className=\"opl-ripple-box\">\n                    <span className=\"opl-ripple-circle\"/>\n                </span>Wybierz\n            </button>\n        </div>);\n    }\n};\n\nSaveVasesButton.propTypes = {\n    unfulfilledRequireRules: PropTypes.array.isRequired,\n    saveVasesClicked: PropTypes.func.isRequired,\n};\n\nconst mapDispatchToProps = dispatch => ({\n    updateCartVases: (bundle, offer, cartBundle, productsToRemove, productsToAdd) => dispatch(updateCartVases(bundle, offer, cartBundle, productsToRemove, productsToAdd)),\n});\n\nexport default connect(null,mapDispatchToProps)(VASModal);"],
    "file": "VasModal.js"
}