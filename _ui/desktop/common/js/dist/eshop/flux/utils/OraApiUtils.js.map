{
    "version": 3,
    "sources": ["../../../../../es6/eshop/flux/utils/OraApiUtils.js"],
    "names": ["promisifyAjaxCall", "ajax", "resolveWrapper", "Promise", "resolve", "reject", "then", "promisifyAjaxCallWrap", "data", "textStatus", "jqXHR", "mock", "output", "timeout", "setTimeout", "mockRandomError", "error", "Math", "random", "baseSetup", "statusCode", "location", "reload", "headers", "val", "cache", "get", "url", "console", "log", "JSON", "stringify", "$", "_", "extend", "dataType", "type", "getPdf", "method", "put", "post", "postWrap", "postWithContentType", "contentType", "postJson", "deleteJson", "postJsonObject", "patch", "postJsonObjectNoResult", "poll", "readyFn", "iterations", "poller", "dt", "catch"],
    "mappings": "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",
    "sourcesContent": ["import $ from \"jquery\";\nimport _ from \"lodash\";\n\n// Needed because jQuery's Deferred does NOT strictly follow the Promise standard\nfunction promisifyAjaxCall(ajax, resolveWrapper) {\n    return new Promise(\n        (resolve, reject) => ajax.then(\n            resolveWrapper ? resolveWrapper(resolve) : resolve,\n            reject\n         )\n    );\n}\n\n//Promise.resolve accepts one arg. Need to wrap 3 args from ajax call\nfunction promisifyAjaxCallWrap(ajax) {\n    return promisifyAjaxCall(ajax,  (resolve) => (data, textStatus, jqXHR) => resolve({data,textStatus,jqXHR}))\n}\n\nexport function mock(data, output, timeout=1000) {\n    return new Promise((resolve, reject) => {\n        setTimeout( () => {\n            resolve(output);\n        }, timeout)\n    });\n}\n\nexport function mockRandomError(data, output, error, timeout=1000) {\n    return new Promise((resolve, reject) => {\n        setTimeout( () => {\n            Math.random() > 0.2 ? resolve(output) : reject(error)\n        }, timeout)\n    });\n}\n\nconst baseSetup = {\n    statusCode: {\n        403: function () {\n            location.reload();\n        },\n    },\n    headers: {\"CSRFToken\": $(\"#CSRFToken\").val()},\n    cache: false,\n};\n\nexport function get(url, data) {\n    console.log(\"GET from \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        data: data,\n        dataType: \"json\",\n        type: \"get\",\n    })));\n}\n\nexport function getPdf(url) {\n    console.log(\"GET from \" + url );\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"GET\",\n        headers: {\n            \"Accept\" : \"application/pdf\",\n        },\n    })));\n}\n\nexport function put(url, data) {\n    console.log(\"PUT to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"PUT\",\n        data: data,\n    })));\n}\n\nexport function post(url, data) {\n    console.log(\"POST to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"POST\",\n        data: data,\n    })));\n}\n\nexport function postWrap(url, data) {\n    console.log(\"POST to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCallWrap($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"POST\",\n        data: data,\n    })));\n}\n\nexport function postWithContentType(url, contentType, data) {\n    console.log(\"POST to \" + url + \" with contentType: \" + contentType + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        method: \"POST\",\n        url,\n        contentType,\n        data,\n    })));\n}\n\nexport function postJson(url, data) {\n    console.log(\"POST to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"POST\",\n        dataType: \"json\",\n        data: data,\n    })));\n}\n\nexport function deleteJson(url, data) {\n    console.log(\"DELETE to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"DELETE\",\n        dataType: \"json\",\n        data: data,\n    })));\n}\n\nexport function postJsonObject(url, data) {\n    console.log(\"POST to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"POST\",\n        dataType: \"json\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify(data),\n    })));\n}\nexport function patch(url, data) {\n    console.log(\"PATCH to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"PATCH\",\n        dataType: \"json\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify(data),\n    })));\n}\n\nexport function postJsonObjectNoResult(url, data) {\n    console.log(\"POST to \" + url + \" with data: \" + JSON.stringify(data));\n    return promisifyAjaxCall($.ajax(_.extend({}, baseSetup, {\n        url: url,\n        method: \"POST\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify(data),\n    })));\n}\n\n/**\n * Utility method for polling a remote controller.\n */\nexport function poll(url, data, readyFn, iterations = 20, timeout=2000) {\n    return new Promise((resolve, reject) => {\n        (function poller() {\n            if (--iterations < 0) {\n                return reject();\n            } else {\n                get(url, data)\n                    .then(dt => {\n                        if (readyFn(dt)) {\n                            return resolve(dt);\n                        } else {\n                            setTimeout(poller, timeout);\n                        }\n                    })\n                    .catch(reject);\n            }\n        })();\n    });\n}\n"],
    "file": "OraApiUtils.js"
}